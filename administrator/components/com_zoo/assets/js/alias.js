/* Copyright (C) YOOtheme GmbH, http://www.gnu.org/licenses/gpl.html GNU/GPL */

!function(a){function o(){}a.extend(o.prototype,{name:"AliasEdit",options:{url:"index.php?option=com_zoo&controller=manager&format=raw&task=getalias",force_safe:!1,edit:!1},initialize:function(t,e){this.options=a.extend({},this.options,e);var i=this;this.input=t,this.trigger=t.find("a.trigger"),this.panel=t.find("div.panel"),this.text=this.panel.find("input:text"),this.name=t.find('input[name="name"]'),this.options.edit||this.name.bind("blur.name",function(){i.name.val().length&&!i.text.val().length&&i.setAlias(i.name.val())}),this.trigger.bind("click",function(t){t.preventDefault(),a(this).hide(),i.panel.addClass("active"),i.text.focus(),i.text.bind("keydown",function(t){t.stopPropagation(),13==t.which&&i.setAlias(i.text.val()),27==t.which&&i.remove()}),i.input.find("input.accept").bind("click",function(t){t.preventDefault(),i.setAlias(i.text.val())}),i.input.find("a.cancel").bind("click",function(t){t.preventDefault(),i.remove()})})},setAlias:function(t){var e=this;t.length||(t=e.name.val()),a.getJSON(this.options.url,{name:t,force_safe:this.options.force_safe?1:0},function(t){if(!t.length){if(e.options.force_safe)return t="",e.panel.addClass("active"),e.text.focus(),void alert("You cannot use non-latin characters for type aliases!");t="42"}e.text.val(t),e.trigger.text(t),a(e).unbind("blur.name"),e.remove()})},remove:function(){this.trigger.show(),this.panel.removeClass("active")}}),a.fn[o.prototype.name]=function(){var i=arguments,n=i[0]?i[0]:null;return this.each(function(){var t,e=a(this);o.prototype[n]&&e.data(o.prototype.name)&&"initialize"!=n?e.data(o.prototype.name)[n].apply(e.data(o.prototype.name),Array.prototype.slice.call(i,1)):!n||a.isPlainObject(n)?(t=new o,o.prototype.initialize&&t.initialize.apply(t,a.merge([e],i)),e.data(o.prototype.name,t)):a.error("Method "+n+" does not exist on jQuery."+o.name)})}}(jQuery);