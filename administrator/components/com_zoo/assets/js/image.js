/* Copyright (C) YOOtheme GmbH, http://www.gnu.org/licenses/gpl.html GNU/GPL */

jQuery(function(o){var c=location.href.match(/^(.+)administrator\/index\.php.*/i)[1];o("input.image-select").each(function(e){var t=o(this),i="image-select-"+e,n=o('<button type="button">').text("Select Image").insertAfter(t),a=o("<span>").addClass("image-cancel").insertAfter(t),r=o("<div>").addClass("image-preview").insertAfter(n);t.attr("id",i),t.val()&&o("<img>").attr("src",c+t.val()).appendTo(r),a.click(function(){t.val(""),r.empty()}),n.click(function(e){e.preventDefault(),SqueezeBox.fromElement(this,{handler:"iframe",url:"index.php?option=com_media&view=images&tmpl=component&e_name="+i,size:{x:800,y:500}})})}),o.isFunction(window.jInsertEditorText)&&(window.insertTextOld=window.jInsertEditorText),window.jInsertEditorText=function(e,t){var i,n;t.match(/^image-select-/)?(i=o("#"+t),n=e.match(/src="([^\"]*)"/)[1],i.parent().find("div.image-preview").html(e).find("img").attr("src",c+n),i.val(n)):o.isFunction(window.insertTextOld)&&window.insertTextOld(e,t)}});