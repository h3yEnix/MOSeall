/* Copyright (C) YOOtheme GmbH, https://www.gnu.org/licenses/gpl.html GNU/GPL */

!function(o){function a(){}o.extend(a.prototype,{name:"ElementGroup",options:{element:null},initialize:function(t,e){this.options=o.extend({},this.options,e);var i=this;this.element=t,this.list=t.children("ul"),this.hidden=this.list.find("li.hidden").detach(),t.delegate("div.delete","click",function(){o(this).parent("li").slideUp(400,function(){o(this).remove(),i.orderOptions()})}).find("div.add").bind("click",function(){i.hidden.clone().removeClass("hidden").appendTo(i.list).slideDown(200).effect("highlight",{},1e3).find("input:first").focus(),i.orderOptions()}),this.list.sortable({handle:"div.sort-handle",containment:this.list.parent().parent(),placeholder:"dragging",axis:"y",opacity:1,revert:75,delay:100,tolerance:"pointer",zIndex:99,start:function(t,e){e.placeholder.height(e.helper.height()),i.list.sortable("refreshPositions")},stop:function(t,e){i.orderOptions()}})},orderOptions:function(){var e=/^(\S+\[element\])\[\d+\](\[name\]|\[type\])$/;this.list.children("li").each(function(t){o(this).find("input,select").each(function(){o(this).attr("name")&&o(this).attr("name",o(this).attr("name").replace(e,"$1["+t+"]$2"))})})}}),o.fn[a.prototype.name]=function(){var i=arguments,n=i[0]||null;return this.each(function(){var t,e=o(this);a.prototype[n]&&e.data(a.prototype.name)&&"initialize"!=n?e.data(a.prototype.name)[n].apply(e.data(a.prototype.name),Array.prototype.slice.call(i,1)):!n||o.isPlainObject(n)?(t=new a,a.prototype.initialize&&t.initialize.apply(t,o.merge([e],i)),e.data(a.prototype.name,t)):o.error("Method "+n+" does not exist on jQuery."+a.name)})}}(jQuery);